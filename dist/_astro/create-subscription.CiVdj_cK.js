import{r as p,j as e,P as S,X as D}from"./react-vendor.BA2wKBqg.js";import{B as o}from"./button.ByCdt4UQ.js";import{D as E,a as P,b as T,c as B,d as I}from"./dialog.BVVCI8f5.js";import{F as V,a as x,b as h,c,d as j,e as f}from"./form.Cnv9BBQA.js";import{I as l}from"./input.CGlmA2MW.js";import{T as k}from"./textarea.DYUaUl6i.js";import{o as N,b as L,n as O,s as m,u as R,a as z}from"./form-vendor.d8L_mb-j.js";import{a as A}from"./api.BiPwSYRr.js";import"./ui-vendor.BQCqNqg0.js";import"./index.DFUPT9Yl.js";import"./label.B1wjpwVS.js";const H=N({name:m().min(2,"Name must be at least 2 characters"),description:m().min(10,"Description must be at least 10 characters"),price:O().min(0,"Price must be a positive number"),features:L(N({name:m().min(2,"Feature name must be at least 2 characters"),description:m().optional()}))});function Z({apiToken:w}){const[v,b]=p.useState(!1),[i,d]=p.useState([]),[t,u]=p.useState({name:"",description:""}),a=R({resolver:z(H),defaultValues:{name:"",description:"",price:0,features:[]}}),C=s=>{const r=i.filter((n,F)=>F!==s);d(r),a.setValue("features",r)},g=async()=>t.name.trim()?new Promise(s=>{d(r=>{const n=[...r,t];return a.setValue("features",n),s(n),n}),u({name:"",description:""})}):i,y=async s=>{try{let r=i;t.name.trim()&&(r=await g());const n=new URL(window.location.href);if(!(await A(n.origin,w,{...s,features:r})).success)throw new Error("Failed to create subscription");a.reset(),d([]),b(!1),window.location.reload()}catch(r){console.error("Error creating subscription:",r)}};return e.jsxs(E,{open:v,onOpenChange:b,children:[e.jsx(P,{asChild:!0,children:e.jsxs(o,{children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Create New Subscription"]})}),e.jsxs(T,{className:"sm:max-w-[600px]",children:[e.jsx(B,{children:e.jsx(I,{children:"Create New Subscription"})}),e.jsx(V,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(y),className:"space-y-4",children:[e.jsx(x,{control:a.control,name:"name",render:({field:s})=>e.jsxs(h,{children:[e.jsx(c,{children:"Name"}),e.jsx(j,{children:e.jsx(l,{placeholder:"Enter subscription name",...s})}),e.jsx(f,{})]})}),e.jsx(x,{control:a.control,name:"description",render:({field:s})=>e.jsxs(h,{children:[e.jsx(c,{children:"Description"}),e.jsx(j,{children:e.jsx(k,{placeholder:"Enter subscription description",...s})}),e.jsx(f,{})]})}),e.jsx(x,{control:a.control,name:"price",render:({field:s})=>e.jsxs(h,{children:[e.jsx(c,{children:"Price"}),e.jsx(j,{children:e.jsx(l,{type:"number",placeholder:"Enter price",...s,onChange:r=>s.onChange(Number(r.target.value))})}),e.jsx(f,{})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{children:"Features"}),e.jsx("div",{className:"space-y-2",children:i.map((s,r)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 border rounded-md",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:s.name}),s.description&&e.jsx("div",{className:"text-sm text-gray-500",children:s.description})]}),e.jsx(o,{type:"button",variant:"ghost",size:"sm",onClick:()=>C(r),children:e.jsx(D,{className:"h-4 w-4"})})]},r))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(l,{placeholder:"Feature name",value:t.name,onChange:s=>u({...t,name:s.target.value})}),e.jsx(l,{placeholder:"Feature description (optional)",value:t.description,onChange:s=>u({...t,description:s.target.value})})]}),e.jsx(o,{type:"button",onClick:g,className:"self-start",children:"Add Feature"})]})]}),e.jsx(o,{type:"submit",className:"w-full",children:"Create Subscription"})]})})]})]})}export{Z as CreateSubscriptionButton};
//# sourceMappingURL=create-subscription.CiVdj_cK.js.map
