import{r,j as e,a9 as be,f as ds,aa as ve,ab as ms,ac as ke,ad as Ce,ae as Se,af as De,w as Ie,ag as Ae,ah as us,ai as Te,aj as Ee,ak as xs,al as hs,am as je,an as ps,L as O,ao as fs,ap as js,aq as gs,ar as Ns,as as ws,at as ge,k as ys,au as bs,av as Ne,P as vs,aw as ks,F as A,C as Cs,ax as we,ay as ye,az as Ss,aA as Ds,aB as Is,aC as As,aD as Ts}from"./react-vendor.BA2wKBqg.js";import{B as y}from"./button.ByCdt4UQ.js";import{I as B}from"./input.CGlmA2MW.js";import{C as P}from"./card.Dz2pXIg4.js";import{S as T}from"./scroll-area.BPg4eSwv.js";import{D as J,b as H,c as V,d as Q}from"./dialog.BVVCI8f5.js";import{A as Es,b as Fs,a as Ms}from"./alert.Cgxt91Jd.js";import{T as Rs,a as Us,b as W,c as G}from"./tabs.C_L4uOLP.js";import{c as j}from"./index.DFUPT9Yl.js";import"./ui-vendor.BQCqNqg0.js";const Ls=xs,Os=hs,Ps=r.forwardRef(({className:o,inset:l,children:d,...m},b)=>e.jsxs(be,{ref:b,className:j("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",l&&"pl-8",o),...m,children:[d,e.jsx(ds,{className:"ml-auto h-4 w-4"})]}));Ps.displayName=be.displayName;const zs=r.forwardRef(({className:o,...l},d)=>e.jsx(ve,{ref:d,className:j("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",o),...l}));zs.displayName=ve.displayName;const Fe=r.forwardRef(({className:o,sideOffset:l=4,...d},m)=>e.jsx(ms,{children:e.jsx(ke,{ref:m,sideOffset:l,className:j("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",o),...d})}));Fe.displayName=ke.displayName;const K=r.forwardRef(({className:o,inset:l,...d},m)=>e.jsx(Ce,{ref:m,className:j("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l&&"pl-8",o),...d}));K.displayName=Ce.displayName;const $s=r.forwardRef(({className:o,children:l,checked:d,...m},b)=>e.jsxs(Se,{ref:b,className:j("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",o),checked:d,...m,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(De,{children:e.jsx(Ie,{className:"h-4 w-4"})})}),l]}));$s.displayName=Se.displayName;const qs=r.forwardRef(({className:o,children:l,...d},m)=>e.jsxs(Ae,{ref:m,className:j("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",o),...d,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(De,{children:e.jsx(us,{className:"h-2 w-2 fill-current"})})}),l]}));qs.displayName=Ae.displayName;const Bs=r.forwardRef(({className:o,inset:l,...d},m)=>e.jsx(Te,{ref:m,className:j("px-2 py-1.5 text-sm font-semibold",l&&"pl-8",o),...d}));Bs.displayName=Te.displayName;const Js=r.forwardRef(({className:o,...l},d)=>e.jsx(Ee,{ref:d,className:j("-mx-1 my-1 h-px bg-muted",o),...l}));Js.displayName=Ee.displayName;function et(){const[o,l]=r.useState([]),[d,m]=r.useState([]),[b,Me]=r.useState([]),[h,E]=r.useState(null),[F,S]=r.useState(""),[M,Y]=r.useState(!1),[X,Z]=r.useState(!1),[_,Re]=r.useState(null),[R,Ue]=r.useState(null),[Le,ee]=r.useState(!1),[se,Oe]=r.useState([]),[Pe,te]=r.useState(!1),[ae,ze]=r.useState(""),[ne,re]=r.useState(null),[oe,ie]=r.useState(!1),[g,le]=r.useState(null),[v,ce]=r.useState(!1),[$e,qe]=r.useState("sources"),[de,Be]=r.useState(""),[Je,me]=r.useState(!1),[He,z]=r.useState(""),U=r.useRef(null),ue=r.useRef(null),Ve=()=>{ue.current?.scrollIntoView({behavior:"smooth"})};r.useEffect(()=>{Ve()},[o]),r.useEffect(()=>{$(),Ye()},[]);function Qe(s){return!!s&&typeof s=="object"&&Array.isArray(s.conversations)}function We(s){return!!s&&typeof s=="object"&&Array.isArray(s.documents)}function Ge(s){return!!s&&typeof s=="object"&&Array.isArray(s.messages)&&Array.isArray(s.documents)}function Ke(s){return!!s&&typeof s=="object"&&Array.isArray(s.documents)}const $=async()=>{try{const s=await fetch("/api/chat/conversations");if(s.ok){const t=await s.json();Qe(t)?Me(t.conversations):console.warn("Unexpected conversations payload")}}catch(s){console.error("Failed to load conversations:",s)}},Ye=async()=>{try{const s=await fetch("/api/chat/documents");if(s.ok){const t=await s.json();We(t)?m(t.documents):console.warn("Unexpected documents payload")}}catch(s){console.error("Failed to load documents:",s)}},Xe=async s=>{try{const t=await fetch(`/api/chat/conversations/${s}`);if(t.ok){const n=await t.json();Ge(n)?(l(n.messages),m(n.documents),E(s)):console.warn("Unexpected conversation detail payload")}}catch(t){console.error("Failed to load conversation:",t)}},Ze=async s=>{const t=s.target.files;if(!t||t.length===0)return;Z(!0);const n=new FormData;Array.from(t).forEach(a=>{n.append("files",a)}),h&&n.append("conversationId",h);try{const a=await fetch("/api/chat/upload",{method:"POST",body:n});if(a.ok){const i=await a.json();if(Ke(i)){const c=i.documents.map(u=>({...u,enabled:!0}));m(u=>[...u,...c]),!h&&i.conversationId&&(E(i.conversationId),await $())}else console.warn("Unexpected upload response payload")}else console.error("Upload failed:",await a.text())}catch(a){console.error("Upload error:",a)}finally{Z(!1),U.current&&(U.current.value="")}},xe=async()=>{if(!F.trim()||M||v)return;const s=F.trim(),t={id:Date.now().toString(),role:"user",content:s,timestamp:new Date};l(a=>[...a,t]),S(""),Y(!0),ce(!0),le(null);const n={id:(Date.now()+1).toString(),role:"assistant",content:"",timestamp:new Date,streaming:!0};l(a=>[...a,n]);try{const a=d.filter(x=>x.enabled!==!1).map(x=>x.id),i=await fetch("/api/chat/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:s,conversationId:h,documentIds:a})});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const c=i.body?.getReader(),u=new TextDecoder;if(c){let x="",k=[],D="";for(;;){const{done:I,value:f}=await c.read();if(I)break;D+=u.decode(f,{stream:!0});const C=D.split(`

`);D=C.pop()||"";for(const N of C){if(!N.trim())continue;const cs=N.split(`
`);for(const fe of cs)if(fe.startsWith("data: ")){const L=fe.slice(6).trim();if(!L||L==="[DONE]")continue;try{const p=JSON.parse(L);if(p.chunks&&(Oe(p.chunks),k=p.chunks),p.content&&(x+=p.content,l(q=>q.map(w=>w.id===n.id?{...w,content:x,citations:k}:w))),p.conversationId&&!h&&(E(p.conversationId),await $()),p.error){console.error("SSE Error:",p.error),l(q=>q.map(w=>w.id===n.id?{...w,content:p.error||"An error occurred",streaming:!1}:w));return}}catch(p){console.error("Failed to parse SSE data:",p,"Data:",L)}}}}if(D.trim()){const I=D.split(`
`);for(const f of I)if(f.startsWith("data: ")){const C=f.slice(6).trim();if(C&&C!=="[DONE]")try{const N=JSON.parse(C);N.content&&(x+=N.content)}catch(N){console.error("Failed to parse final SSE data:",N)}}}l(I=>I.map(f=>f.id===n.id?{...f,content:x||"No response received",streaming:!1}:f))}}catch(a){console.error("Chat error:",a);let i="Sorry, an error occurred. Please try again.",c=!1;a instanceof Error&&(a.message.includes("workers-ai-failed")||a.message.includes("AI service is at capacity")||a.message.includes("Rate limit exceeded")||a.message.includes("rate limit")||a.message.includes("Daily quota limit reached")||a.message.includes("AI service access denied")||a.message.includes("AI service is temporarily unavailable")||a.message.includes("AI service is not properly configured")||a.message.includes("Concurrency limit")||a.message.includes("concurrent"))&&(i=a.message.split(" - ")[0]||a.message,c=!0,le(i)),l(u=>u.map(x=>x.id===n.id?{...x,content:c?"":i,streaming:!1}:x)),c&&l(u=>u.filter(x=>x.id!==n.id))}finally{Y(!1),ce(!1)}},_e=async s=>{try{(await fetch(`/api/chat/documents/${s}`,{method:"DELETE"})).ok&&m(n=>n.filter(a=>a.id!==s))}catch(t){console.error("Failed to delete document:",t)}},es=()=>{E(null),l([]),m([])},ss=s=>s<1024?s+" B":s<1024*1024?(s/1024).toFixed(1)+" KB":(s/(1024*1024)).toFixed(1)+" MB",ts=s=>{m(t=>t.map(n=>n.id===s?{...n,enabled:!n.enabled}:n))},as=s=>{const t=se.find(n=>n.id===s);t&&(Ue(t),ee(!0))},ns=(s,t)=>{if(!t||t.length===0)return e.jsx("span",{className:"whitespace-pre-wrap",children:s});const n=s.split(/(\^\[\d+\])/g);return e.jsx("span",{className:"whitespace-pre-wrap",children:n.map((a,i)=>{const c=a.match(/\^\[(\d+)\]/);if(c){const u=parseInt(c[1]);return e.jsx("button",{onClick:()=>as(u),className:"inline-flex items-center justify-center w-5 h-5 text-xs rounded-full bg-primary/20 text-primary hover:bg-primary/30 transition-colors align-super ml-0.5",title:`View source ${u}`,children:u},i)}return e.jsx("span",{children:a},i)})})},rs=async s=>{const t=o.findIndex(c=>c.id===s);if(t===-1)return;let n=t;if(o[t].role==="assistant"){for(let c=t-1;c>=0;c--)if(o[c].role==="user"){n=c;break}}const a=o[n].content,i=o[t].role==="assistant"?o[t].content:o[t+1]?.content||"";re(s);try{const c=await fetch("/api/chat/share",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:a,answer:i,citations:o[t].citations||se})});if(c.ok){const u=await c.json();(k=>!!k&&typeof k=="object"&&typeof k.shareUrl=="string")(u)?(ze(u.shareUrl),te(!0)):console.warn("Unexpected share payload")}else console.error("Failed to create share link")}catch(c){console.error("Error sharing message:",c)}finally{re(null)}},os=async()=>{try{await navigator.clipboard.writeText(ae),ie(!0),setTimeout(()=>ie(!1),2e3)}catch(s){console.error("Failed to copy:",s)}},he=async s=>{if(!(!h||o.length===0))try{const t=await fetch("/api/chat/export",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({conversationId:h,format:s})});if(t.ok){const n=await t.blob(),a=window.URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download=`conversation-${h}.${s==="markdown"?"md":"json"}`,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(a),document.body.removeChild(i)}else console.error("Failed to export conversation")}catch(t){console.error("Error exporting conversation:",t)}},is=async s=>{Re(s),me(!0);try{const t=await fetch(`/api/chat/documents/${s.id}`);if(t.ok){const n=await t.json();(i=>!!i&&typeof i=="object"&&("content"in i?typeof i.content=="string"||typeof i.content>"u":!0))(n)?z(n.content||"No preview available"):(console.warn("Unexpected document content payload"),z("No preview available"))}}catch(t){console.error("Failed to load document content:",t),z("Failed to load document content")}},ls=s=>s.includes("image")?As:s.includes("code")||s.includes("json")?Ts:A,pe=d.filter(s=>s.name.toLowerCase().includes(de.toLowerCase()));return e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-96 border-r bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(je,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"font-semibold",children:"NotebookLM"})]}),e.jsxs(Rs,{value:$e,onValueChange:qe,children:[e.jsxs(Us,{className:"grid w-full grid-cols-3",children:[e.jsx(W,{value:"sources",children:"Sources"}),e.jsx(W,{value:"notebook",children:"Notebook"}),e.jsx(W,{value:"history",children:"History"})]}),e.jsx(G,{value:"sources",className:"mt-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(B,{placeholder:"Search documents...",value:de,onChange:s=>Be(s.target.value),className:"pl-9"})]}),e.jsx(y,{className:"w-full gradient-metallic-primary",onClick:()=>U.current?.click(),disabled:X,children:X?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(fs,{className:"w-4 h-4 mr-2"}),"Add Sources"]})}),e.jsx(T,{className:"h-[calc(100vh-250px)]",children:e.jsx("div",{className:"space-y-2",children:pe.length===0?e.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[e.jsx(js,{className:"w-8 h-8 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No sources uploaded"}),e.jsx("p",{className:"text-xs mt-1",children:"Add documents to get started"})]}):pe.map(s=>{const t=ls(s.type);return e.jsx(P,{className:`p-3 cursor-pointer transition-all hover:shadow-md ${_?.id===s.id?"ring-2 ring-primary":""}`,onClick:()=>is(s),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(t,{className:"w-5 h-5 text-muted-foreground flex-shrink-0 mt-0.5"}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[ss(s.size)," • ",s.chunks," chunks"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Uploaded ",new Date(s.uploadedAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{variant:"ghost",size:"icon",className:"w-8 h-8",onClick:n=>{n.stopPropagation(),ts(s.id)},title:s.enabled?"Disable document":"Enable document",children:s.enabled?e.jsx(gs,{className:"w-4 h-4"}):e.jsx(Ns,{className:"w-4 h-4 text-muted-foreground"})}),e.jsx(y,{variant:"ghost",size:"icon",className:"w-8 h-8 hover:text-destructive",onClick:n=>{n.stopPropagation(),_e(s.id)},children:e.jsx(ws,{className:"w-4 h-4"})})]})]})})]})},s.id)})})})]})}),e.jsx(G,{value:"notebook",className:"mt-4",children:e.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[e.jsx(ge,{className:"w-8 h-8 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Notebook coming soon"}),e.jsx("p",{className:"text-xs mt-1",children:"Your AI-generated notes and insights"})]})}),e.jsx(G,{value:"history",className:"mt-4",children:e.jsx(T,{className:"h-[calc(100vh-250px)]",children:e.jsx("div",{className:"space-y-2",children:b.length===0?e.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[e.jsx(ys,{className:"w-8 h-8 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No conversations yet"})]}):b.map(s=>e.jsxs("button",{onClick:()=>Xe(s.id),className:`w-full text-left p-3 rounded-lg transition-all group relative ${s.id===h?"bg-gradient-to-r from-gradient-metal-start to-gradient-metal-end text-white shadow-sm":"hover:bg-muted/80"}`,children:[e.jsx("p",{className:`font-medium text-sm truncate ${s.id===h?"text-white":""}`,children:s.title}),e.jsx("p",{className:`text-xs truncate mt-1 ${s.id===h?"text-white/80":"text-muted-foreground"}`,children:s.lastMessage}),e.jsxs("div",{className:`flex items-center gap-1 mt-1 text-xs ${s.id===h?"text-white/60":"text-muted-foreground"}`,children:[e.jsx(bs,{className:"w-3 h-3"}),new Date(s.timestamp).toLocaleDateString()]})]},s.id))})})})]})]}),e.jsx("input",{ref:U,type:"file",multiple:!0,accept:".txt,.pdf,.doc,.docx,.md,.json,.csv",onChange:Ze,className:"hidden"})]}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"border-b px-6 py-3 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ne,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"font-semibold",children:"AI Assistant"}),d.filter(s=>s.enabled).length>0&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",d.filter(s=>s.enabled).length," sources active)"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(y,{onClick:es,variant:"outline",size:"sm",children:[e.jsx(vs,{className:"w-4 h-4 mr-2"}),"New Chat"]}),h&&o.length>0&&e.jsxs(Ls,{children:[e.jsx(Os,{asChild:!0,children:e.jsx(y,{variant:"ghost",size:"icon",children:e.jsx(ks,{className:"w-4 h-4"})})}),e.jsxs(Fe,{align:"end",children:[e.jsxs(K,{onClick:()=>he("markdown"),children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Export as Markdown"]}),e.jsxs(K,{onClick:()=>he("json"),children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Export as JSON"]})]})]})]})]})}),e.jsx(T,{className:"flex-1 px-6",children:e.jsxs("div",{className:"max-w-3xl mx-auto py-6",children:[g&&e.jsxs(Es,{variant:"warning",className:"mb-4",children:[e.jsx(Cs,{className:"h-4 w-4"}),e.jsx(Fs,{children:"AI Service Issue"}),e.jsxs(Ms,{children:[g,(g.includes("quota")||g.toLowerCase().includes("rate limit"))&&e.jsx("p",{className:"mt-2 text-sm",children:"Free tier limits: 100k requests/day, 20 requests/minute, 2 concurrent GPU jobs. Consider upgrading for better performance."}),g.includes("capacity")&&e.jsx("p",{className:"mt-2 text-sm",children:"The AI service is experiencing high demand. Please wait a moment and try again."}),(g.toLowerCase().includes("concurrent")||g.includes("Concurrency limit"))&&e.jsx("p",{className:"mt-2 text-sm",children:"The free tier allows only 2 concurrent AI requests. Your request has been queued and will process when a slot becomes available."})]})]}),o.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-r from-gradient-metal-start to-gradient-metal-end mb-4",children:e.jsx(we,{className:"w-8 h-8 text-white"})}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"How can I help you today?"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Upload documents and ask questions to get started"}),e.jsxs("div",{className:"space-y-4 max-w-md mx-auto",children:[e.jsx(P,{className:"p-4 cursor-pointer hover:shadow-md transition-all",onClick:()=>S("Summarize the key points from my documents"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(je,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-sm",children:"Summarize documents"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Get key insights from your sources"})]})]})}),e.jsx(P,{className:"p-4 cursor-pointer hover:shadow-md transition-all",onClick:()=>S("Create an outline based on the main topics"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-sm",children:"Generate outline"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Structure your content logically"})]})]})}),e.jsx(P,{className:"p-4 cursor-pointer hover:shadow-md transition-all",onClick:()=>S("What are the most important findings?"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ne,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-sm",children:"Extract insights"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Discover key findings and patterns"})]})]})})]})]}):e.jsxs("div",{className:"space-y-6",children:[o.map(s=>e.jsxs("div",{className:`flex gap-4 ${s.role==="assistant"?"":"justify-end"}`,children:[s.role==="assistant"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-gradient-metal-start to-gradient-metal-end flex items-center justify-center flex-shrink-0",children:e.jsx(we,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"relative rounded-2xl px-4 py-3 max-w-[80%] group bg-muted",children:[e.jsx("div",{className:"text-sm leading-relaxed",children:ns(s.content,s.citations)}),s.streaming&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(O,{className:"w-3 h-3 animate-spin text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"AI is typing..."})]}),s.role==="assistant"&&!s.streaming&&e.jsx("button",{onClick:()=>rs(s.id),disabled:ne===s.id,className:`absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity ${s.role==="assistant"?"text-muted-foreground hover:text-foreground":"text-white/70 hover:text-white"}`,title:"Share this Q&A",children:ne===s.id?e.jsx(O,{className:"w-4 h-4 animate-spin"}):e.jsx(ye,{className:"w-4 h-4"})})]})]}),s.role==="user"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative rounded-2xl px-4 py-3 max-w-[80%] group bg-muted",children:e.jsx("div",{className:"text-sm leading-relaxed",children:s.content})}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-muted flex items-center justify-center flex-shrink-0",children:e.jsx(Ss,{className:"w-5 h-5"})})]})]},s.id)),e.jsx("div",{ref:ue})]})]})}),e.jsx("div",{className:"border-t bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsx("div",{className:"px-6 py-4",children:e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(B,{value:F,onChange:s=>S(s.target.value),onKeyPress:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),xe())},placeholder:v?"AI is responding...":"Ask a question about your documents...",disabled:M||v,className:"flex-1"}),e.jsx(y,{onClick:xe,disabled:M||v||!F.trim(),className:"gradient-metallic-primary flex-shrink-0",title:v?"Please wait for the current response to complete":"Send message",children:M||v?e.jsx(O,{className:"w-4 h-4 animate-spin"}):e.jsx(Ds,{className:"w-4 h-4"})})]})})})})]}),e.jsx(J,{open:Je,onOpenChange:me,children:e.jsxs(H,{className:"max-w-4xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsx(V,{children:e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5"}),_?.name]})}),e.jsx(T,{className:"flex-1 mt-4",children:e.jsx("div",{className:"p-4 bg-muted rounded-lg",children:e.jsx("pre",{className:"whitespace-pre-wrap text-sm font-mono",children:He})})})]})}),e.jsx(J,{open:Le,onOpenChange:ee,children:e.jsxs(H,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsx(V,{children:e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5"}),"Source: ",R?.documentName]})}),e.jsx(T,{className:"flex-1 mt-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Relevance:"}),e.jsxs("span",{children:[R?(R.score*100).toFixed(1):0,"%"]})]}),e.jsx("div",{className:"p-4 bg-muted rounded-lg",children:e.jsx("pre",{className:"whitespace-pre-wrap text-sm font-mono",children:R?.text})})]})})]})}),e.jsx(J,{open:Pe,onOpenChange:te,children:e.jsxs(H,{className:"max-w-md",children:[e.jsx(V,{children:e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5"}),"Share This Conversation"]})}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Anyone with this link can view this Q&A snippet. The link will expire in 30 days."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(B,{value:ae,readOnly:!0,className:"font-mono text-xs"}),e.jsx(y,{onClick:os,variant:"outline",size:"icon",className:"flex-shrink-0",children:oe?e.jsx(Ie,{className:"w-4 h-4 text-green-600"}):e.jsx(Is,{className:"w-4 h-4"})})]}),oe&&e.jsx("p",{className:"text-sm text-green-600",children:"Link copied to clipboard!"})]})]})})]})}export{et as NotebookLMInterface};
//# sourceMappingURL=NotebookLMInterface.CYI0-EGU.js.map
