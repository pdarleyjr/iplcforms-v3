{"version":3,"file":"plausible.astro.mjs","sources":["../../../../../src/pages/api/analytics/plausible.ts"],"sourcesContent":["export async function ALL(ctx: any): Promise<Response> {\r\n  // If E2E or no PLAUSIBLE_DOMAIN configured, return 204 to avoid failures\r\n  const e2e = ctx.request.headers.get('x-e2e');\r\n  const domain = ctx.env?.PLAUSIBLE_DOMAIN;\r\n  if (e2e || !domain) return new Response(null, { status: 204 });\r\n  // Forward JSON body to Plausible API\r\n  try {\r\n    const body = await ctx.request.text();\r\n    const resp = await fetch(`https://${domain}/api/event`, {\r\n      method: 'POST',\r\n      headers: { 'content-type': 'application/json' },\r\n      body\r\n    });\r\n    return new Response(null, { status: resp.ok ? 204 : 502 });\r\n  } catch {\r\n    return new Response(null, { status: 204 });\r\n  }\r\n}"],"names":[],"mappings":";;;AAAA,eAAsB,IAAI,GAAA,EAA6B;AAErD,EAAA,MAAM,GAAA,GAAM,GAAA,CAAI,OAAA,CAAQ,OAAA,CAAQ,IAAI,OAAO,CAAA;AAC3C,EAAA,MAAM,MAAA,GAAS,IAAI,GAAA,EAAK,gBAAA;AACxB,EAAA,IAAI,GAAA,IAAO,CAAC,MAAA,EAAQ,OAAO,IAAI,SAAS,IAAA,EAAM,EAAE,MAAA,EAAQ,GAAA,EAAK,CAAA;AAE7D,EAAA,IAAI;AACF,IAAA,MAAM,IAAA,GAAO,MAAM,GAAA,CAAI,OAAA,CAAQ,IAAA,EAAK;AACpC,IAAA,MAAM,IAAA,GAAO,MAAM,KAAA,CAAM,CAAA,QAAA,EAAW,MAAM,CAAA,UAAA,CAAA,EAAc;AAAA,MACtD,MAAA,EAAQ,MAAA;AAAA,MACR,OAAA,EAAS,EAAE,cAAA,EAAgB,kBAAA,EAAmB;AAAA,MAC9C;AAAA,KACD,CAAA;AACD,IAAA,OAAO,IAAI,SAAS,IAAA,EAAM,EAAE,QAAQ,IAAA,CAAK,EAAA,GAAK,GAAA,GAAM,GAAA,EAAK,CAAA;AAAA,EAC3D,CAAA,CAAA,MAAQ;AACN,IAAA,OAAO,IAAI,QAAA,CAAS,IAAA,EAAM,EAAE,MAAA,EAAQ,KAAK,CAAA;AAAA,EAC3C;AACF;;;;;;;;;;;"}