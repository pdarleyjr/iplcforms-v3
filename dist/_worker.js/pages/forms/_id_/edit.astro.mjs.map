{"version":3,"file":"edit.astro.mjs","sources":["../../../../../src/pages/forms/[id]/edit.astro"],"sourcesContent":["---\r\nexport const prerender = false;\r\n\r\nimport Layout from '@/layouts/Layout.astro';\r\nimport { Button } from '@/components/ui/button';\r\nimport { FormBuilder } from '@/components/form-builder/FormBuilder';\r\nimport { ComponentPalette } from '@/components/form-builder/ComponentPalette';\r\nimport { FormTemplateService } from '@/lib/services/form_template';\r\n\r\nconst { id } = Astro.params;\r\n\r\nif (!id) {\r\n  return Astro.redirect('/forms');\r\n}\r\n\r\nconst { DB } = Astro.locals.env || {};\r\nconst formTemplateService = new FormTemplateService(DB);\r\n\r\nlet template;\r\ntry {\r\n  template = await formTemplateService.getById(parseInt(id));\r\n  if (!template) {\r\n    return Astro.redirect('/forms');\r\n  }\r\n} catch (error) {\r\n  console.error('Error loading form template:', error);\r\n  return Astro.redirect('/forms');\r\n}\r\n---\r\n\r\n<Layout title={`Edit Form: ${template.name}`}>\r\n  <div class=\"space-y-8\">\r\n    <div class=\"flex items-center justify-between\">\r\n      <div>\r\n        <h1 class=\"text-3xl font-bold tracking-tight\">Edit Form</h1>\r\n        <p class=\"text-muted-foreground\">\r\n          Editing: <span class=\"font-medium\">{template.name}</span> (Version {template.version})\r\n        </p>\r\n      </div>\r\n      <div class=\"flex gap-2\">\r\n        <Button variant=\"outline\">\r\n          <a href={`/forms/${id}/preview`}>Preview</a>\r\n        </Button>\r\n        <Button variant=\"outline\">\r\n          <a href=\"/forms\">‚Üê Back to Forms</a>\r\n        </Button>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\r\n      <!-- Component Palette -->\r\n      <div class=\"lg:col-span-1\">\r\n        <div class=\"sticky top-6\">\r\n          <h3 class=\"text-lg font-semibold mb-4\">Components</h3>\r\n          <ComponentPalette client:only=\"react\" />\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Form Builder -->\r\n      <div class=\"lg:col-span-3\">\r\n        <div class=\"border rounded-lg\">\r\n          <FormBuilder \r\n            client:only=\"react\"\r\n            mode=\"edit\"\r\n            templateId={template.id}\r\n            initialTemplate={template}\r\n            onSave={(updatedTemplate) => {\r\n              // Handle form save\r\n              window.location.href = `/forms/${template.id}/preview`;\r\n            }}\r\n            onCancel={() => {\r\n              window.location.href = '/forms';\r\n            }}\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <style>\r\n    /* Ensure proper drag and drop styling */\r\n    .form-builder-container {\r\n      min-height: 600px;\r\n    }\r\n    \r\n    .component-palette {\r\n      max-height: 80vh;\r\n      overflow-y: auto;\r\n    }\r\n  </style>\r\n\r\n  <script define:vars={{ template }}>\r\n    // Make template data available to React components\r\n    window.__FORM_TEMPLATE__ = template;\r\n  </script>\r\n</Layout>"],"names":["$$createAstro","$$createComponent","Astro","$$render","$$renderComponent","Layout","$$result","$$maybeRenderHead","$$addAttribute","$$defineScriptVars"],"mappings":"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"}