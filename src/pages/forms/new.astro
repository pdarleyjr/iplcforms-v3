---
import Layout from '@/layouts/Layout.astro';
import { Button } from '@/components/ui/button';
import { FormBuilder } from '@/components/form-builder/FormBuilder';
---

<Layout title="Create New Form">
  <div class="space-y-8">
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-3xl font-bold tracking-tight">Create New Form</h1>
        <p class="text-muted-foreground">Design your custom form with drag-and-drop components</p>
      </div>
      <Button variant="outline">
        <a href="/forms">‚Üê Back to Forms</a>
      </Button>
    </div>

    <!-- Form Builder now contains the ComponentPalette internally -->
    <div class="w-full">
      <FormBuilder
        client:only="react"
        mode="create"
        data-testid="form-builder"
        onSave={(template) => {
          // Handle form save
          window.location.href = '/forms';
        }}
        onCancel={() => {
          window.location.href = '/forms';
        }}
      />
    </div>
  </div>

  <style>
    /* Ensure proper drag and drop styling */
    .form-builder-container {
      min-height: 600px;
    }
    
    .component-palette {
      max-height: 80vh;
      overflow-y: auto;
    }
  </style>
</Layout>