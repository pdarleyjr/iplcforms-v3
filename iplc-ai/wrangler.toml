name = "iplc-ai"
main = "src/index.ts"
compatibility_date = "2025-04-01"

# AI binding configuration
[ai]
binding = "AI"

# Vectorize configuration for document embeddings
[[vectorize]]
binding = "VECTORIZE"
index_name = "iplc-chat-index"

# KV namespace for document metadata
[[kv_namespaces]]
binding = "DOC_METADATA"
id = "DOC_METADATA_ID_PLACEHOLDER"
preview_id = "DOC_METADATA_ID_PLACEHOLDER"

# KV namespace for session data
[[kv_namespaces]]
binding = "SESSION"
id = "SESSION_ID_PLACEHOLDER"
preview_id = "SESSION_ID_PLACEHOLDER"

# Durable Objects for session management
[[durable_objects.bindings]]
name = "SESSION_DO"
class_name = "SessionDO"

[[durable_objects.bindings]]
name = "AI_GATE"
class_name = "AIGate"

# Migrations for Durable Objects
[[migrations]]
tag = "v1"
new_classes = [ "SessionDO" ]

[[migrations]]
tag = "v3-aigate-sqlite"
new_sqlite_classes = ["AIGate"]

# Cron triggers for scheduled cleanup
[triggers]
crons = ["0 2 * * *"]  # Run daily at 2 AM UTC

# Environment specific settings
[env.development]
vars = { }